(function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};window.THREEFLOW=window.THREEFLOW||{},THREEFLOW.DatGui=a=function(){function a(a){var b,d,e=this;if(this.renderer=a,this._onRender=c(this._onRender,this),!window.dat&&!window.dat.GUI)throw new Error("No dat.GUI found.");dat.GUI.prototype.removeFolder=function(a){return console.log("REMOVE",this,a),this.__folders[a].close(),this.__ul.removeChild(this.__folders[a].li),dom.removeClass(this.__folders[a].li,"folder"),this.__folders[a]=void 0,this.onResize()},this.gui=new dat.GUI,this.onRender=null,this.gui.add(this,"_onRender").name("Render"),this.imageFolder=this.gui.addFolder("Image"),this.traceDepthsFolder=this.gui.addFolder("Trace Depths"),this.causticsFolder=this.gui.addFolder("Caustics"),this.giFolder=this.gui.addFolder("Global Illumination"),this.meshFolder=this.gui.addFolder("Mesh Options"),this.geometryFolder=this.gui.addFolder("Geometry Options"),this.imageFolder.add(this.renderer.image,"antialiasMin"),this.imageFolder.add(this.renderer.image,"antialiasMax"),this.imageFolder.add(this.renderer.image,"samples"),this.imageFolder.add(this.renderer.image,"contrast"),this.imageFolder.add(this.renderer.image,"filter",this.renderer.image.filterTypes),this.imageFolder.add(this.renderer.image,"jitter"),this.traceDepthsFolder.add(this.renderer.traceDepths,"enabled"),this.traceDepthsFolder.add(this.renderer.traceDepths,"diffusion"),this.traceDepthsFolder.add(this.renderer.traceDepths,"reflection"),this.traceDepthsFolder.add(this.renderer.traceDepths,"refraction"),this.causticsFolder.add(this.renderer.caustics,"enabled"),this.causticsFolder.add(this.renderer.caustics,"photons"),this.causticsFolder.add(this.renderer.caustics,"kdEstimate"),this.causticsFolder.add(this.renderer.caustics,"kdRadius"),this.meshFolder.add(this.renderer.meshes,"convertPrimitives"),this.geometryFolder.add(this.renderer.geometry,"faceNormals"),this.geometryFolder.add(this.renderer.geometry,"vertexNormals"),this.giFolder.add(this.renderer.gi,"enabled"),this.giFolder.add(this.renderer.gi,"type",this.renderer.gi.types).onChange(function(a){return d(a)}),this.giTypes=[{type:this.renderer.gi.types[0],name:"Instant GI",property:"igi"},{type:this.renderer.gi.types[1],name:"Irradiance Caching / Final Gathering",property:"irrCache"},{type:this.renderer.gi.types[2],name:"Path Tracing",property:"path"},{type:this.renderer.gi.types[3],name:"Ambient Occlusion",property:"ambOcc"},{type:this.renderer.gi.types[4],name:"Fake Ambient Term",property:"fake"}],this.giSubFolder=null,b=function(a){var b,c,d,f,g;if(e.giSubFolder){for(c=e.giSubFolder.__controllers.slice(0),f=0,g=c.length;g>f;f++)b=c[f],e.giSubFolder.remove(b);e.giSubFolder.__controllers.splice(0),e.giSubFolder.__ul.firstChild.innerHTML=a.name}else e.giSubFolder=e.giFolder.addFolder(a.name);for(d in e.renderer.gi[a.property])"irr-cache"===a.type&&"globalMap"===d?e.giSubFolder.add(e.renderer.gi.irrCache,"globalMap",e.renderer.gi.globalMapTypes):"ambocc"!==a.type||"bright"!==d&&"dark"!==d?"fake"===a.type?console.log("SKIPPED FAKE AMBIENT TERM GI(TODO)"):e.giSubFolder.add(e.renderer.gi[a.property],d):e.giSubFolder.addColor(e.renderer.gi[a.property],d);return null},(d=function(a){return e.renderer.gi.type=a,b(e.giTypes[e.renderer.gi.types.indexOf(a)]),null})(this.renderer.gi.type)}return a.prototype._onRender=function(){return this.onRender?this.onRender():void 0},a}(),THREEFLOW.LightingBox=b=function(){function a(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;null==a&&(a={}),THREE.Object3D.call(this),p=a.size||100,o=a.segments||2,l=a.scaleX||1,m=a.scaleY||1,n=a.scaleZ||1,i=a.materials||null,(!i||i.length<6)&&(j=new THREEFLOW.DiffuseMaterial({color:16711680,side:THREE.DoubleSide}),g=new THREEFLOW.DiffuseMaterial({color:65280,side:THREE.DoubleSide}),c=new THREEFLOW.DiffuseMaterial({color:255,side:THREE.DoubleSide}),t=new THREEFLOW.DiffuseMaterial({color:16776960,side:THREE.DoubleSide}),s=new THREEFLOW.DiffuseMaterial({color:16448250,side:THREE.DoubleSide}),i=[s,s,j,g,c,t]),f=new THREE.PlaneGeometry(p,p,o,o),r=new THREE.Mesh(f,i[0]),d=new THREE.Mesh(f,i[1]),h=new THREE.Mesh(f,i[2]),k=new THREE.Mesh(f,i[3]),e=new THREE.Mesh(f,i[4]),b=new THREE.Mesh(f,i[5]),q=p/2,r.position.set(0,p,0),r.rotation.x=d.rotation.x=Math.PI/2,d.position.set(0,0,0),h.position.set(-q,q,0),k.position.set(q,q,0),h.rotation.y=k.rotation.y=Math.PI/2,e.position.set(0,q,q),b.position.set(0,q,-q),this.add(r),this.add(d),this.add(h),this.add(k),this.add(e),this.add(b),this.scale.x=l,this.scale.y=m,this.scale.z=n}return a.prototype=Object.create(THREE.Object3D.prototype),a}()}).call(this);